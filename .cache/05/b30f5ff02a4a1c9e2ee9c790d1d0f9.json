{"id":"ndY2","dependencies":[{"name":"/Users/lennertderyck/Documents/GitHub/begrotingen/package.json","includedInParent":true,"mtime":1598613936257},{"name":"./dataControl","loc":{"line":5,"column":19},"parent":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/sharesControl.js","resolved":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/dataControl.js"},{"name":"./uiControl","loc":{"line":2,"column":49},"parent":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/sharesControl.js","resolved":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/uiControl.js"},{"name":"moment","loc":{"line":3,"column":19},"parent":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/sharesControl.js","resolved":"/Users/lennertderyck/Documents/GitHub/begrotingen/node_modules/moment/moment.js"},{"name":"./plugins/firebase","loc":{"line":4,"column":17},"parent":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/sharesControl.js","resolved":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/plugins/firebase.js"},{"name":"./utils","loc":{"line":6,"column":21},"parent":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/sharesControl.js","resolved":"/Users/lennertderyck/Documents/GitHub/begrotingen/static/modules/utils.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.shares=void 0;var e=require(\"./dataControl\"),a=require(\"./uiControl\"),t=i(require(\"moment\")),s=require(\"./plugins/firebase\"),o=require(\"./utils\");function i(e){return e&&e.__esModule?e:{default:e}}const r={async init(e){r.watchForElements();const t=await r.getShareData(e.id);if(null!=t.data){1==r.valid(t)?r.pass(t):r.unvalidate(t)}else console.log(\"sharecode not available\"),a.templates.switch(\"shareNotFound\")},watchForElements(){const e=(0,o.node)(\"body\");new MutationObserver(()=>{a.ui.shareMode(!0)}).observe(e,{subtree:!0,childList:!0})},async new(a){const t=await e.data.createDoc(\"shares\",{validity:a.validity,target:a.target}),s=`${window.location.origin}/#s/${t}`;await(0,o.node)('[data-form=\"budgetShare\"]').classList.add(\"d-none\"),await(0,o.node)('[data-label=\"linkPreview\"]').classList.add(\"d-block\"),(0,o.node)('[data-label=\"linkPreview\"] input').value=s,(0,o.node)('[data-label=\"copyShareUrl\"]').setAttribute(\"data-clipboard\",s)},async getShareData(e){const a=s.db.collection(\"shares\").doc(e);return{id:e,data:(await a.get()).data()}},valid(e){const a=(0,t.default)(),s=(0,t.default)(e.data.validity);return a.diff(s,\"days\")>0?(console.log(\"share not valid\"),!1):(console.log(\"share valid\"),!0)},async pass(t){const s=await e.budget.get(t.data.target);window.appSettings.selectedBudget=s,await a.render.costs(s)},async unvalidate(e){const t=await s.db.doc(`shares/${e.id}`).delete();a.templates.switch(\"shareNotFound\"),console.log(t)},copyUrlFeedback(){(0,a.createToast)({title:\"Url gekopieerd\",content:\"Plak hem waar nodig\"})},getCurrentLinks(){}};exports.shares=r;"},"sourceMaps":{"js":{"mappings":[{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":0}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":13}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":20}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":35}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":43}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":56}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":57}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":64}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":68}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":76}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":88}},{"source":"static/modules/sharesControl.js","original":{"line":1,"column":0},"generated":{"line":1,"column":90}},{"source":"static/modules/sharesControl.js","original":{"line":1,"column":0},"generated":{"line":1,"column":94}},{"source":"static/modules/sharesControl.js","original":{"line":1,"column":0},"generated":{"line":1,"column":96}},{"source":"static/modules/sharesControl.js","original":{"line":1,"column":0},"generated":{"line":1,"column":104}},{"source":"static/modules/sharesControl.js","original":{"line":2,"column":0},"generated":{"line":1,"column":121}},{"source":"static/modules/sharesControl.js","original":{"line":2,"column":0},"generated":{"line":1,"column":123}},{"source":"static/modules/sharesControl.js","original":{"line":2,"column":0},"generated":{"line":1,"column":131}},{"source":"static/modules/sharesControl.js","original":{"line":3,"column":0},"generated":{"line":1,"column":146}},{"source":"static/modules/sharesControl.js","original":{"line":3,"column":0},"generated":{"line":1,"column":148}},{"source":"static/modules/sharesControl.js","original":{"line":3,"column":0},"generated":{"line":1,"column":150}},{"source":"static/modules/sharesControl.js","original":{"line":3,"column":0},"generated":{"line":1,"column":158}},{"source":"static/modules/sharesControl.js","original":{"line":4,"column":0},"generated":{"line":1,"column":169}},{"source":"static/modules/sharesControl.js","original":{"line":4,"column":0},"generated":{"line":1,"column":171}},{"source":"static/modules/sharesControl.js","original":{"line":4,"column":0},"generated":{"line":1,"column":179}},{"source":"static/modules/sharesControl.js","original":{"line":6,"column":0},"generated":{"line":1,"column":201}},{"source":"static/modules/sharesControl.js","original":{"line":6,"column":0},"generated":{"line":1,"column":203}},{"source":"static/modules/sharesControl.js","original":{"line":6,"column":0},"generated":{"line":1,"column":211}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":222}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":231}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":233}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":236}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":243}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":246}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":248}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":259}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":261}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":262}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":270}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":273}},{"source":"static/modules/sharesControl.js","name":"shares","original":{"line":10,"column":6},"generated":{"line":1,"column":279}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":15},"generated":{"line":1,"column":281}},{"source":"static/modules/sharesControl.js","name":"init","original":{"line":11,"column":10},"generated":{"line":1,"column":282}},{"source":"static/modules/sharesControl.js","name":"params","original":{"line":11,"column":15},"generated":{"line":1,"column":293}},{"source":"static/modules/sharesControl.js","name":"shares","original":{"line":12,"column":8},"generated":{"line":1,"column":296}},{"source":"static/modules/sharesControl.js","name":"watchForElements","original":{"line":12,"column":15},"generated":{"line":1,"column":298}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":14,"column":14},"generated":{"line":1,"column":317}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":14,"column":14},"generated":{"line":1,"column":323}},{"source":"static/modules/sharesControl.js","name":"shares","original":{"line":14,"column":32},"generated":{"line":1,"column":331}},{"source":"static/modules/sharesControl.js","name":"getShareData","original":{"line":14,"column":39},"generated":{"line":1,"column":333}},{"source":"static/modules/sharesControl.js","name":"params","original":{"line":14,"column":52},"generated":{"line":1,"column":346}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":14,"column":59},"generated":{"line":1,"column":348}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":15,"column":12},"generated":{"line":1,"column":352}},{"source":"static/modules/sharesControl.js","name":"undefined","original":{"line":15,"column":30},"generated":{"line":1,"column":355}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":15,"column":12},"generated":{"line":1,"column":361}},{"source":"static/modules/sharesControl.js","name":"data","original":{"line":15,"column":22},"generated":{"line":1,"column":363}},{"source":"static/modules/sharesControl.js","original":{"line":15,"column":41},"generated":{"line":1,"column":368}},{"source":"static/modules/sharesControl.js","original":{"line":17,"column":25},"generated":{"line":1,"column":369}},{"source":"static/modules/sharesControl.js","name":"shares","original":{"line":16,"column":26},"generated":{"line":1,"column":372}},{"source":"static/modules/sharesControl.js","name":"valid","original":{"line":16,"column":33},"generated":{"line":1,"column":374}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":16,"column":39},"generated":{"line":1,"column":380}},{"source":"static/modules/sharesControl.js","name":"shares","original":{"line":17,"column":31},"generated":{"line":1,"column":383}},{"source":"static/modules/sharesControl.js","name":"pass","original":{"line":17,"column":38},"generated":{"line":1,"column":385}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":17,"column":43},"generated":{"line":1,"column":390}},{"source":"static/modules/sharesControl.js","name":"shares","original":{"line":18,"column":17},"generated":{"line":1,"column":393}},{"source":"static/modules/sharesControl.js","name":"unvalidate","original":{"line":18,"column":24},"generated":{"line":1,"column":395}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":18,"column":35},"generated":{"line":1,"column":406}},{"source":"static/modules/sharesControl.js","name":"console","original":{"line":20,"column":12},"generated":{"line":1,"column":414}},{"source":"static/modules/sharesControl.js","name":"log","original":{"line":20,"column":20},"generated":{"line":1,"column":422}},{"source":"static/modules/sharesControl.js","original":{"line":20,"column":24},"generated":{"line":1,"column":426}},{"source":"static/modules/sharesControl.js","name":"switch","original":{"line":21,"column":22},"generated":{"line":1,"column":453}},{"source":"static/modules/sharesControl.js","name":"switch","original":{"line":21,"column":22},"generated":{"line":1,"column":455}},{"source":"static/modules/sharesControl.js","name":"switch","original":{"line":21,"column":22},"generated":{"line":1,"column":465}},{"source":"static/modules/sharesControl.js","original":{"line":21,"column":29},"generated":{"line":1,"column":472}},{"source":"static/modules/sharesControl.js","name":"watchForElements","original":{"line":25,"column":4},"generated":{"line":1,"column":490}},{"source":"static/modules/sharesControl.js","name":"elementToObserve","original":{"line":26,"column":14},"generated":{"line":1,"column":509}},{"source":"static/modules/sharesControl.js","name":"elementToObserve","original":{"line":26,"column":14},"generated":{"line":1,"column":515}},{"source":"static/modules/sharesControl.js","original":{"line":26,"column":33},"generated":{"line":1,"column":518}},{"source":"static/modules/sharesControl.js","original":{"line":26,"column":38},"generated":{"line":1,"column":520}},{"source":"static/modules/sharesControl.js","original":{"line":26,"column":38},"generated":{"line":1,"column":522}},{"source":"static/modules/sharesControl.js","original":{"line":26,"column":38},"generated":{"line":1,"column":528}},{"source":"static/modules/sharesControl.js","original":{"line":27,"column":25},"generated":{"line":1,"column":536}},{"source":"static/modules/sharesControl.js","name":"MutationObserver","original":{"line":27,"column":29},"generated":{"line":1,"column":540}},{"source":"static/modules/sharesControl.js","original":{"line":27,"column":46},"generated":{"line":1,"column":557}},{"source":"static/modules/sharesControl.js","name":"shareMode","original":{"line":28,"column":15},"generated":{"line":1,"column":562}},{"source":"static/modules/sharesControl.js","name":"shareMode","original":{"line":28,"column":15},"generated":{"line":1,"column":564}},{"source":"static/modules/sharesControl.js","name":"shareMode","original":{"line":28,"column":15},"generated":{"line":1,"column":567}},{"source":"static/modules/sharesControl.js","original":{"line":28,"column":25},"generated":{"line":1,"column":578}},{"source":"static/modules/sharesControl.js","name":"observe","original":{"line":30,"column":17},"generated":{"line":1,"column":583}},{"source":"static/modules/sharesControl.js","name":"elementToObserve","original":{"line":30,"column":25},"generated":{"line":1,"column":591}},{"source":"static/modules/sharesControl.js","original":{"line":30,"column":43},"generated":{"line":1,"column":593}},{"source":"static/modules/sharesControl.js","name":"subtree","original":{"line":30,"column":44},"generated":{"line":1,"column":594}},{"source":"static/modules/sharesControl.js","original":{"line":30,"column":53},"generated":{"line":1,"column":603}},{"source":"static/modules/sharesControl.js","name":"childList","original":{"line":30,"column":59},"generated":{"line":1,"column":605}},{"source":"static/modules/sharesControl.js","original":{"line":30,"column":70},"generated":{"line":1,"column":616}},{"source":"static/modules/sharesControl.js","name":"new","original":{"line":33,"column":10},"generated":{"line":1,"column":621}},{"source":"static/modules/sharesControl.js","name":"formData","original":{"line":33,"column":14},"generated":{"line":1,"column":631}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":34,"column":14},"generated":{"line":1,"column":634}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":34,"column":14},"generated":{"line":1,"column":640}},{"source":"static/modules/sharesControl.js","name":"data","original":{"line":34,"column":25},"generated":{"line":1,"column":648}},{"source":"static/modules/sharesControl.js","name":"createDoc","original":{"line":34,"column":30},"generated":{"line":1,"column":650}},{"source":"static/modules/sharesControl.js","name":"createDoc","original":{"line":34,"column":30},"generated":{"line":1,"column":655}},{"source":"static/modules/sharesControl.js","original":{"line":34,"column":40},"generated":{"line":1,"column":665}},{"source":"static/modules/sharesControl.js","original":{"line":34,"column":50},"generated":{"line":1,"column":674}},{"source":"static/modules/sharesControl.js","name":"validity","original":{"line":35,"column":12},"generated":{"line":1,"column":675}},{"source":"static/modules/sharesControl.js","name":"formData","original":{"line":35,"column":22},"generated":{"line":1,"column":684}},{"source":"static/modules/sharesControl.js","name":"validity","original":{"line":35,"column":31},"generated":{"line":1,"column":686}},{"source":"static/modules/sharesControl.js","name":"target","original":{"line":36,"column":12},"generated":{"line":1,"column":695}},{"source":"static/modules/sharesControl.js","name":"formData","original":{"line":36,"column":20},"generated":{"line":1,"column":702}},{"source":"static/modules/sharesControl.js","name":"target","original":{"line":36,"column":29},"generated":{"line":1,"column":704}},{"source":"static/modules/sharesControl.js","name":"url","original":{"line":39,"column":14},"generated":{"line":1,"column":713}},{"source":"static/modules/sharesControl.js","name":"window","original":{"line":39,"column":23},"generated":{"line":1,"column":718}},{"source":"static/modules/sharesControl.js","name":"location","original":{"line":39,"column":30},"generated":{"line":1,"column":725}},{"source":"static/modules/sharesControl.js","name":"origin","original":{"line":39,"column":39},"generated":{"line":1,"column":734}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":39,"column":52},"generated":{"line":1,"column":747}},{"source":"static/modules/sharesControl.js","original":{"line":41,"column":14},"generated":{"line":1,"column":757}},{"source":"static/modules/sharesControl.js","original":{"line":41,"column":19},"generated":{"line":1,"column":759}},{"source":"static/modules/sharesControl.js","original":{"line":41,"column":19},"generated":{"line":1,"column":761}},{"source":"static/modules/sharesControl.js","original":{"line":41,"column":19},"generated":{"line":1,"column":767}},{"source":"static/modules/sharesControl.js","name":"classList","original":{"line":41,"column":48},"generated":{"line":1,"column":796}},{"source":"static/modules/sharesControl.js","name":"add","original":{"line":41,"column":58},"generated":{"line":1,"column":806}},{"source":"static/modules/sharesControl.js","original":{"line":41,"column":62},"generated":{"line":1,"column":810}},{"source":"static/modules/sharesControl.js","original":{"line":42,"column":14},"generated":{"line":1,"column":826}},{"source":"static/modules/sharesControl.js","original":{"line":42,"column":19},"generated":{"line":1,"column":828}},{"source":"static/modules/sharesControl.js","original":{"line":42,"column":19},"generated":{"line":1,"column":830}},{"source":"static/modules/sharesControl.js","original":{"line":42,"column":19},"generated":{"line":1,"column":836}},{"source":"static/modules/sharesControl.js","name":"classList","original":{"line":42,"column":49},"generated":{"line":1,"column":866}},{"source":"static/modules/sharesControl.js","name":"add","original":{"line":42,"column":59},"generated":{"line":1,"column":876}},{"source":"static/modules/sharesControl.js","original":{"line":42,"column":63},"generated":{"line":1,"column":880}},{"source":"static/modules/sharesControl.js","original":{"line":43,"column":13},"generated":{"line":1,"column":892}},{"source":"static/modules/sharesControl.js","original":{"line":43,"column":13},"generated":{"line":1,"column":894}},{"source":"static/modules/sharesControl.js","original":{"line":43,"column":13},"generated":{"line":1,"column":896}},{"source":"static/modules/sharesControl.js","original":{"line":43,"column":13},"generated":{"line":1,"column":902}},{"source":"static/modules/sharesControl.js","name":"value","original":{"line":43,"column":49},"generated":{"line":1,"column":938}},{"source":"static/modules/sharesControl.js","name":"url","original":{"line":43,"column":57},"generated":{"line":1,"column":944}},{"source":"static/modules/sharesControl.js","original":{"line":44,"column":13},"generated":{"line":1,"column":947}},{"source":"static/modules/sharesControl.js","original":{"line":44,"column":13},"generated":{"line":1,"column":949}},{"source":"static/modules/sharesControl.js","original":{"line":44,"column":13},"generated":{"line":1,"column":951}},{"source":"static/modules/sharesControl.js","original":{"line":44,"column":13},"generated":{"line":1,"column":957}},{"source":"static/modules/sharesControl.js","name":"setAttribute","original":{"line":44,"column":44},"generated":{"line":1,"column":988}},{"source":"static/modules/sharesControl.js","original":{"line":44,"column":57},"generated":{"line":1,"column":1001}},{"source":"static/modules/sharesControl.js","name":"url","original":{"line":44,"column":75},"generated":{"line":1,"column":1018}},{"source":"static/modules/sharesControl.js","name":"getShareData","original":{"line":47,"column":10},"generated":{"line":1,"column":1022}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":47,"column":23},"generated":{"line":1,"column":1041}},{"source":"static/modules/sharesControl.js","name":"snapshot","original":{"line":48,"column":14},"generated":{"line":1,"column":1044}},{"source":"static/modules/sharesControl.js","name":"snapshot","original":{"line":48,"column":14},"generated":{"line":1,"column":1050}},{"source":"static/modules/sharesControl.js","name":"db","original":{"line":48,"column":25},"generated":{"line":1,"column":1052}},{"source":"static/modules/sharesControl.js","name":"collection","original":{"line":48,"column":28},"generated":{"line":1,"column":1054}},{"source":"static/modules/sharesControl.js","name":"collection","original":{"line":48,"column":28},"generated":{"line":1,"column":1057}},{"source":"static/modules/sharesControl.js","original":{"line":48,"column":39},"generated":{"line":1,"column":1068}},{"source":"static/modules/sharesControl.js","name":"doc","original":{"line":48,"column":49},"generated":{"line":1,"column":1078}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":48,"column":53},"generated":{"line":1,"column":1082}},{"source":"static/modules/sharesControl.js","original":{"line":50,"column":15},"generated":{"line":1,"column":1085}},{"source":"static/modules/sharesControl.js","original":{"line":50,"column":15},"generated":{"line":1,"column":1091}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":51,"column":12},"generated":{"line":1,"column":1092}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":51,"column":16},"generated":{"line":1,"column":1095}},{"source":"static/modules/sharesControl.js","name":"data","original":{"line":52,"column":12},"generated":{"line":1,"column":1097}},{"source":"static/modules/sharesControl.js","name":"snapshot","original":{"line":49,"column":27},"generated":{"line":1,"column":1109}},{"source":"static/modules/sharesControl.js","name":"get","original":{"line":49,"column":36},"generated":{"line":1,"column":1111}},{"source":"static/modules/sharesControl.js","name":"data","original":{"line":52,"column":23},"generated":{"line":1,"column":1118}},{"source":"static/modules/sharesControl.js","name":"valid","original":{"line":56,"column":4},"generated":{"line":1,"column":1127}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":56,"column":10},"generated":{"line":1,"column":1133}},{"source":"static/modules/sharesControl.js","name":"now","original":{"line":57,"column":14},"generated":{"line":1,"column":1136}},{"source":"static/modules/sharesControl.js","name":"now","original":{"line":57,"column":14},"generated":{"line":1,"column":1142}},{"source":"static/modules/sharesControl.js","original":{"line":57,"column":20},"generated":{"line":1,"column":1145}},{"source":"static/modules/sharesControl.js","original":{"line":57,"column":8},"generated":{"line":1,"column":1147}},{"source":"static/modules/sharesControl.js","original":{"line":57,"column":8},"generated":{"line":1,"column":1149}},{"source":"static/modules/sharesControl.js","name":"validDate","original":{"line":58,"column":14},"generated":{"line":1,"column":1160}},{"source":"static/modules/sharesControl.js","original":{"line":58,"column":26},"generated":{"line":1,"column":1163}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":58,"column":33},"generated":{"line":1,"column":1165}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":58,"column":33},"generated":{"line":1,"column":1167}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":58,"column":33},"generated":{"line":1,"column":1176}},{"source":"static/modules/sharesControl.js","name":"data","original":{"line":58,"column":43},"generated":{"line":1,"column":1178}},{"source":"static/modules/sharesControl.js","name":"validity","original":{"line":58,"column":48},"generated":{"line":1,"column":1183}},{"source":"static/modules/sharesControl.js","name":"diff","original":{"line":61,"column":12},"generated":{"line":1,"column":1193}},{"source":"static/modules/sharesControl.js","name":"now","original":{"line":59,"column":21},"generated":{"line":1,"column":1200}},{"source":"static/modules/sharesControl.js","name":"diff","original":{"line":59,"column":25},"generated":{"line":1,"column":1202}},{"source":"static/modules/sharesControl.js","name":"validDate","original":{"line":59,"column":30},"generated":{"line":1,"column":1207}},{"source":"static/modules/sharesControl.js","original":{"line":59,"column":41},"generated":{"line":1,"column":1209}},{"source":"static/modules/sharesControl.js","original":{"line":61,"column":19},"generated":{"line":1,"column":1217}},{"source":"static/modules/sharesControl.js","name":"console","original":{"line":61,"column":23},"generated":{"line":1,"column":1220}},{"source":"static/modules/sharesControl.js","name":"log","original":{"line":61,"column":31},"generated":{"line":1,"column":1228}},{"source":"static/modules/sharesControl.js","original":{"line":61,"column":35},"generated":{"line":1,"column":1232}},{"source":"static/modules/sharesControl.js","original":{"line":61,"column":62},"generated":{"line":1,"column":1252}},{"source":"static/modules/sharesControl.js","name":"console","original":{"line":62,"column":14},"generated":{"line":1,"column":1256}},{"source":"static/modules/sharesControl.js","name":"log","original":{"line":62,"column":22},"generated":{"line":1,"column":1264}},{"source":"static/modules/sharesControl.js","original":{"line":62,"column":26},"generated":{"line":1,"column":1268}},{"source":"static/modules/sharesControl.js","original":{"line":62,"column":49},"generated":{"line":1,"column":1284}},{"source":"static/modules/sharesControl.js","name":"pass","original":{"line":65,"column":10},"generated":{"line":1,"column":1288}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":65,"column":15},"generated":{"line":1,"column":1299}},{"source":"static/modules/sharesControl.js","name":"budgetsData","original":{"line":66,"column":14},"generated":{"line":1,"column":1302}},{"source":"static/modules/sharesControl.js","name":"budgetsData","original":{"line":66,"column":14},"generated":{"line":1,"column":1308}},{"source":"static/modules/sharesControl.js","name":"budget","original":{"line":66,"column":34},"generated":{"line":1,"column":1316}},{"source":"static/modules/sharesControl.js","name":"get","original":{"line":66,"column":41},"generated":{"line":1,"column":1318}},{"source":"static/modules/sharesControl.js","name":"get","original":{"line":66,"column":41},"generated":{"line":1,"column":1325}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":66,"column":45},"generated":{"line":1,"column":1329}},{"source":"static/modules/sharesControl.js","name":"data","original":{"line":66,"column":55},"generated":{"line":1,"column":1331}},{"source":"static/modules/sharesControl.js","name":"target","original":{"line":66,"column":60},"generated":{"line":1,"column":1336}},{"source":"static/modules/sharesControl.js","name":"window","original":{"line":67,"column":8},"generated":{"line":1,"column":1344}},{"source":"static/modules/sharesControl.js","name":"appSettings","original":{"line":67,"column":15},"generated":{"line":1,"column":1351}},{"source":"static/modules/sharesControl.js","name":"selectedBudget","original":{"line":67,"column":27},"generated":{"line":1,"column":1363}},{"source":"static/modules/sharesControl.js","name":"budgetsData","original":{"line":67,"column":44},"generated":{"line":1,"column":1378}},{"source":"static/modules/sharesControl.js","name":"render","original":{"line":69,"column":14},"generated":{"line":1,"column":1386}},{"source":"static/modules/sharesControl.js","name":"costs","original":{"line":69,"column":21},"generated":{"line":1,"column":1388}},{"source":"static/modules/sharesControl.js","name":"costs","original":{"line":69,"column":21},"generated":{"line":1,"column":1395}},{"source":"static/modules/sharesControl.js","name":"budgetsData","original":{"line":69,"column":27},"generated":{"line":1,"column":1401}},{"source":"static/modules/sharesControl.js","name":"unvalidate","original":{"line":72,"column":10},"generated":{"line":1,"column":1405}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":72,"column":21},"generated":{"line":1,"column":1422}},{"source":"static/modules/sharesControl.js","name":"deleted","original":{"line":73,"column":14},"generated":{"line":1,"column":1425}},{"source":"static/modules/sharesControl.js","name":"deleted","original":{"line":73,"column":14},"generated":{"line":1,"column":1431}},{"source":"static/modules/sharesControl.js","name":"db","original":{"line":73,"column":30},"generated":{"line":1,"column":1439}},{"source":"static/modules/sharesControl.js","name":"doc","original":{"line":73,"column":33},"generated":{"line":1,"column":1441}},{"source":"static/modules/sharesControl.js","name":"doc","original":{"line":73,"column":33},"generated":{"line":1,"column":1444}},{"source":"static/modules/sharesControl.js","name":"shareData","original":{"line":73,"column":47},"generated":{"line":1,"column":1458}},{"source":"static/modules/sharesControl.js","name":"id","original":{"line":73,"column":57},"generated":{"line":1,"column":1460}},{"source":"static/modules/sharesControl.js","name":"delete","original":{"line":73,"column":63},"generated":{"line":1,"column":1466}},{"source":"static/modules/sharesControl.js","name":"switch","original":{"line":74,"column":18},"generated":{"line":1,"column":1475}},{"source":"static/modules/sharesControl.js","name":"switch","original":{"line":74,"column":18},"generated":{"line":1,"column":1477}},{"source":"static/modules/sharesControl.js","name":"switch","original":{"line":74,"column":18},"generated":{"line":1,"column":1487}},{"source":"static/modules/sharesControl.js","original":{"line":74,"column":25},"generated":{"line":1,"column":1494}},{"source":"static/modules/sharesControl.js","name":"console","original":{"line":75,"column":8},"generated":{"line":1,"column":1511}},{"source":"static/modules/sharesControl.js","name":"log","original":{"line":75,"column":16},"generated":{"line":1,"column":1519}},{"source":"static/modules/sharesControl.js","name":"deleted","original":{"line":75,"column":20},"generated":{"line":1,"column":1523}},{"source":"static/modules/sharesControl.js","name":"copyUrlFeedback","original":{"line":78,"column":4},"generated":{"line":1,"column":1527}},{"source":"static/modules/sharesControl.js","original":{"line":79,"column":20},"generated":{"line":1,"column":1546}},{"source":"static/modules/sharesControl.js","original":{"line":79,"column":20},"generated":{"line":1,"column":1548}},{"source":"static/modules/sharesControl.js","original":{"line":79,"column":20},"generated":{"line":1,"column":1550}},{"source":"static/modules/sharesControl.js","original":{"line":79,"column":20},"generated":{"line":1,"column":1563}},{"source":"static/modules/sharesControl.js","name":"title","original":{"line":80,"column":12},"generated":{"line":1,"column":1564}},{"source":"static/modules/sharesControl.js","original":{"line":80,"column":19},"generated":{"line":1,"column":1570}},{"source":"static/modules/sharesControl.js","name":"content","original":{"line":81,"column":12},"generated":{"line":1,"column":1587}},{"source":"static/modules/sharesControl.js","original":{"line":81,"column":21},"generated":{"line":1,"column":1595}},{"source":"static/modules/sharesControl.js","name":"getCurrentLinks","original":{"line":85,"column":4},"generated":{"line":1,"column":1620}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":1641}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":1649}},{"source":"static/modules/sharesControl.js","original":{"line":10,"column":0},"generated":{"line":1,"column":1656}}],"sources":{"static/modules/sharesControl.js":"import {budget} from './dataControl'\nimport {templates, render, ui, createToast} from './uiControl'\nimport moment from 'moment';\nimport {db} from './plugins/firebase';\nimport {data} from './dataControl';\nimport { node } from './utils';\n\n// https://console.firebase.google.com/u/3/project/begrotingen-haegepoorters/firestore/data~2Fshares\n\nconst shares = {\n    async init(params) {     \n        shares.watchForElements();\n        \n        const shareData = await shares.getShareData(params.id);\n        if (shareData.data != undefined) {\n            const valid = shares.valid(shareData);\n            if (valid == true) shares.pass(shareData);\n            else shares.unvalidate(shareData);\n        } else {\n            console.log('sharecode not available');\n            templates.switch('shareNotFound');\n        }\n    },\n    \n    watchForElements() {\n        const elementToObserve = node('body');\n        const observer = new MutationObserver(() => {\n            ui.shareMode(true);\n        });\n        observer.observe(elementToObserve, {subtree: true, childList: true});\n    },\n    \n    async new(formData) {\n        const id = await data.createDoc('shares', {\n            validity: formData.validity,\n            target: formData.target,\n        })\n        \n        const url = `${window.location.origin}/#s/${id}`;\n        \n        await node('[data-form=\"budgetShare\"]').classList.add('d-none');\n        await node('[data-label=\"linkPreview\"]').classList.add('d-block');\n        node('[data-label=\"linkPreview\"] input').value = url;\n        node('[data-label=\"copyShareUrl\"]').setAttribute('data-clipboard', url);\n    },\n    \n    async getShareData(id) {\n        const snapshot = db.collection('shares').doc(id);\n        const data = await snapshot.get();\n        return {\n            id: id,\n            data: data.data()\n        }\n    },\n    \n    valid(shareData) {\n        const now = moment();\n        const validDate = moment(shareData.data.validity);\n        const diff = now.diff(validDate, 'days');\n        \n        if (diff > 0) {console.log('share not valid'); return false}\n        else {console.log('share valid'); return true}\n    },\n    \n    async pass(shareData) {\n        const budgetsData = await budget.get(shareData.data.target);\n        window.appSettings.selectedBudget = budgetsData;\n\n        await render.costs(budgetsData);\n    },\n    \n    async unvalidate(shareData) {\n        const deleted = await db.doc(`shares/${shareData.id}`).delete();\n        templates.switch('shareNotFound');\n        console.log(deleted);\n    },\n    \n    copyUrlFeedback() {\n        createToast({\n            title: 'Url gekopieerd',\n            content: 'Plak hem waar nodig'\n        })\n    },\n    \n    getCurrentLinks() {\n        // check budget id\n        // check shares pointing to budget id\n        // list\n    }\n}\n\nexport {shares}\n\n"},"lineCount":null}},"error":null,"hash":"b09daa97589520664a57476b1ebfb576","cacheData":{"env":{}}}